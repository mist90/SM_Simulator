Version 4
SHEET 1 2708 720
WIRE 1200 -192 1152 -192
WIRE 1312 -192 1280 -192
WIRE 1424 -192 1392 -192
WIRE 1568 -192 1504 -192
WIRE 1200 -48 1152 -48
WIRE 1312 -48 1280 -48
WIRE 1424 -48 1392 -48
WIRE 1568 -48 1504 -48
WIRE 752 32 368 32
WIRE 768 32 752 32
WIRE 368 64 368 32
WIRE 752 64 752 32
WIRE 752 144 752 128
WIRE 368 160 368 144
WIRE 752 240 368 240
WIRE 368 272 368 240
WIRE 752 272 752 240
WIRE 368 368 368 352
WIRE 752 368 752 336
WIRE 400 432 368 432
WIRE 368 464 368 432
WIRE 368 560 368 544
FLAG 1152 -192 I1_in
IOPIN 1152 -192 BiDir
FLAG 1568 -192 I1_out
IOPIN 1568 -192 BiDir
FLAG 1152 -48 I2_in
IOPIN 1152 -48 BiDir
FLAG 1568 -48 I2_out
IOPIN 1568 -48 BiDir
FLAG 768 32 Angle
IOPIN 768 32 Out
FLAG 752 144 0
FLAG 368 160 0
FLAG 752 368 0
FLAG 368 368 0
FLAG 752 240 omega
FLAG 368 560 0
FLAG 400 432 PowerTorque
SYMBOL cap 736 64 R0
SYMATTR InstName C1
SYMATTR Value 1
SYMBOL bi 368 144 R180
WINDOW 0 24 80 Left 2
WINDOW 3 -90 -3 Left 2
SYMATTR InstName B1
SYMATTR Value I=(V(omega))
SYMBOL cap 736 272 R0
SYMATTR InstName C2
SYMATTR Value 1
SYMBOL bi 368 352 R180
WINDOW 0 24 80 Left 2
WINDOW 3 -786 -2 Left 2
SYMATTR InstName B2
SYMATTR Value I=((V(PowerTorque) - FrictionTorque(V(Angle), V(omega)))/J)
SYMBOL ind 1296 -208 R90
WINDOW 0 5 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName L1
SYMATTR Value 4.6E-03
SYMBOL res 1408 -208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 1.2
SYMBOL ind 1296 -64 R90
WINDOW 0 5 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName L2
SYMATTR Value 4.6E-03
SYMBOL res 1408 -64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 1.2
SYMBOL bv 368 448 R0
WINDOW 3 -47 98 Left 2
SYMATTR Value V=(ElectricTorque(V(Angle), I(L1), I(L2)) - DetentTorque(V(Angle)))
SYMATTR InstName B3
SYMBOL bv 1408 -48 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -38 227 VBottom 2
SYMATTR InstName B4
SYMATTR Value V=(GetInducedVoltage(V(Angle), V(omega)))
SYMBOL bv 1408 -192 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -35 226 VBottom 2
SYMATTR InstName B5
SYMATTR Value V=(GetInducedVoltage(V(Angle), V(omega)))
TEXT 320 -304 Left 2 !.param N=200
TEXT 320 -280 Left 2 !.param J=570E-07
TEXT 320 -256 Left 2 !.param K=21E-02*9.8/2.8
TEXT 320 -160 Left 2 !.param DT=k*Flowmax
TEXT 320 -136 Left 2 !.param FTc=0.022
TEXT 320 -328 Left 2 ;Mechanical parameters
TEXT 808 -328 Left 2 ;Electrical parameters
TEXT 808 -304 Left 2 !.param L=4.6E-03
TEXT 808 -280 Left 2 !.param R=1.2
TEXT 320 8 Left 2 ;dPhi(t)/dt = Omega(t)
TEXT 320 216 Left 2 ;dOmega(t)/dt = M(t)/J
TEXT 304 656 Left 2 !.func ElectricTorque(phi, I1, I2) {K*(I1*sin(N*phi/4.0) - I2*cos(N*phi/4.0))}
TEXT 304 680 Left 2 !.func DetentTorque(phi) {DT*sin(N*phi)}
TEXT 304 704 Left 2 !.func FrictionTorque(phi, omega) {sqrt(2.0*2.7)*(FTbrk-FTc)*exp(-(omega/(brkOmega*sqrt(2.0)))**2)*omega/(brkOmega*sqrt(2.0)) + FTc*tanh(omega/(brkOmega/10.0))}
TEXT 320 -232 Left 2 !.param k=K/L
TEXT 320 -208 Left 2 !.param Vmax=62.6
TEXT 568 -208 Left 2 !.param fmax=905.44
TEXT 320 -112 Left 2 !.param FTbrk=0.036
TEXT 320 -88 Left 2 !.param brkOmega=3.14
TEXT 304 632 Left 2 !.func GetInducedVoltage(phi, omega) {N*Flowmax*omega*cos(N*phi)}
TEXT 320 -184 Left 2 !.param Flowmax=Vmax/(2.0*pi*fmax)
